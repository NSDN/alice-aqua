{"version":3,"sources":["webpack:///webpack/bootstrap a4ac364432d5a613d282","webpack:///./src/index.ts","webpack:///./src/utils/chunks.ts","webpack:///./src/babylon.ts","webpack:///./src/utils/tiles.ts","webpack:///./src/utils/index.ts","webpack:///./src/ui.ts","webpack:///./src/utils/dom.ts","webpack:///./src/utils/babylon.ts"],"names":[],"mappings":"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","file":"build/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a4ac364432d5a613d282","import Player from './objs/player'\nimport Sprite from './objs/sprite'\nimport Trigger from './objs/trigger'\nimport TriggerBoard from './objs/trigger-board'\nimport Gate from './objs/gate'\nimport Box from './objs/box'\nimport Ground from './objs/ground'\n\nimport Chunks from './utils/chunks'\n\nimport {\n  Engine,\n  Scene,\n  Mesh,\n  ArcRotateCamera,\n  Vector2,\n  Vector3,\n  Color3,\n  StandardMaterial,\n  ScreenSpaceCanvas2D,\n  DirectionalLight,\n  ShadowGenerator,\n  SSAORenderingPipeline,\n} from './babylon'\n\nimport {\n  UI\n} from './ui'\n\nimport {\n  appendElement,\n  attachDragable,\n} from './utils/dom'\n\nimport {\n  WireframeNoLightingMaterial\n} from './utils/babylon'\n\nconst IMG_ASSETS = {\n  imAssetTile1: 'assets/rpg_maker_vx_rtp_tileset_by_telles0808.png'\n}\n\nconst TILE_ASSETS: [string, number, number, number, boolean][] = [\n  ['imAssetTile1',   16,  624, 32, false],\n  ['imAssetTile1',  512,  320, 32, true],\n  ['imAssetTile1',  384, 1088, 32, true],\n  ['imAssetTile1',  768,  992, 32, true],\n  ['imAssetTile1',  512,    0, 32, true],\n  ['imAssetTile1',  576,    0, 32, true],\n  ['imAssetTile1',    0,  480, 32, true],\n  ['imAssetTile1',    0,  576, 32, true],\n  ['imAssetTile1',   64,  480, 32, true],\n  ['imAssetTile1',   64,  576, 32, true],\n]\n\nconst KEY_MAP = {\n  [16]: 'shiftKey',\n  [17]: 'ctrlKey',\n}\n\nconst cssContent = `\nhtml, body, .full-size {\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n}\n`\n\nconst keys = {\n  shiftKey: false,\n  ctrlKey: false,\n}\n\nfunction getMousePickTarget(scene: Scene, evt: MouseEvent, filter: (mesh: Mesh) => boolean) {\n  const ray = scene.createPickingRay(evt.clientX, evt.clientY, null, scene.activeCamera),\n    pick = scene.pickWithRay(ray, filter),\n    pos = pick.pickedPoint || Vector3.Zero(),\n    norm = pick.getNormal() || Vector3.Zero()\n\n  if (!pick.hit) {\n    const factor = -ray.origin.y / ray.direction.y\n    pos.copyFrom(ray.origin.add(ray.direction.multiplyByFloats(factor, factor, factor)))\n    norm.copyFromFloats(0, 1, 0)\n  }\n\n  const position = new Vector3(Math.floor(pos.x + 0.5), Math.floor(pos.y + 0.5), Math.floor(pos.z + 0.5))\n  const normMaxComp = Math.max(Math.abs(norm.x), Math.abs(norm.y), Math.abs(norm.z))\n  const direction =\n    normMaxComp ===  norm.y ? 'y' : normMaxComp === -norm.y ? '-y' :\n    normMaxComp ===  norm.z ? 'z' : normMaxComp === -norm.z ? '-z' :\n    normMaxComp ===  norm.x ? 'x' : '-x'\n\n  return { position, direction }\n}\n\nappendElement('style', { innerHTML: cssContent }, document.querySelector('head'))\n\nconst elem = appendElement('canvas', { className: 'full-size' }) as HTMLCanvasElement,\n  engine = new Engine(elem, true),\n  scene = new Scene(engine),\n  canvas = new ScreenSpaceCanvas2D(scene, { id: 'canvas' })\n\n//scene.enablePhysics(new Vector3(0, -3, 0))\n//scene.workerCollisions = true\n\nengine.runRenderLoop(() => {\n  scene.render()\n})\n\nwindow.addEventListener('resize', () => {\n  engine.resize()\n})\n\nwindow.addEventListener('keydown', evt => {\n  keys[ KEY_MAP[evt.which] ] = true\n})\n\nwindow.addEventListener('keyup', evt => {\n  keys[ KEY_MAP[evt.which] ] = false\n})\n\n// ...\nconst camera = scene.activeCamera = new ArcRotateCamera('camera', 0, 0, 50, null, scene)\ncamera.lowerRadiusLimit = 10\ncamera.upperRadiusLimit = 100\ncamera.lowerBetaLimit = Math.PI * 0.15\ncamera.upperBetaLimit = Math.PI * 0.45\n\nconst light = new DirectionalLight('light', new Vector3(0.5, -1, 0.5), scene)\nlight.position.copyFromFloats(0, 50, 0)\nlight.intensity = 1\n\nconst ssao = new SSAORenderingPipeline('ssaopipeline', scene, 1, [camera])\n\n;(async function() {\n  let bottomText = null as BABYLON.Text2D\n  new BABYLON.Rectangle2D({\n    parent: canvas,\n    position: new Vector2(10, 10),\n    children: [\n      bottomText = new BABYLON.Text2D('...')\n    ]\n  })\n\n  const cursorHover = Mesh.CreateBox('cursorHover', 1, scene)\n  cursorHover.material = new WireframeNoLightingMaterial('', scene)\n\n  const cursorSelect = Mesh.CreateBox('cursorSelect', 1, scene)\n  cursorSelect.material = new WireframeNoLightingMaterial('', scene, new Color3(1, 0.5, 0.5))\n\n  const pickFilter = mesh => mesh !== cursorHover && mesh !== cursorSelect\n\n  const cursor = {\n    hover: Vector3.Zero(),\n    start: Vector3.Zero(),\n    min: Vector3.Zero(),\n    max: Vector3.Zero(),\n    direction: '',\n    shiftKey: false,\n    ctrlKey: false,\n  }\n  \n  window.addEventListener('mousedown', evt => {\n    const { position, direction } = getMousePickTarget(scene, evt, pickFilter)\n    cursor.hover.copyFrom(position)\n    cursor.start.copyFrom(position)\n    cursor.min.copyFrom(position)\n    cursor.max.copyFrom(position.add(new Vector3(1, 1, 1)))\n    cursor.direction = direction\n    cursor.shiftKey = evt.shiftKey\n    cursor.ctrlKey = evt.ctrlKey\n\n    cursorHover.position.copyFrom(position.add(new Vector3(0.5, 0.5, 0.5)))\n    cursorSelect.position.copyFrom(cursorHover.position)\n    cursorSelect.scaling.copyFromFloats(1, 1, 1)\n  })\n\n  window.addEventListener('mousemove', evt => {\n    const { position } = getMousePickTarget(scene, evt, pickFilter),\n      limitedDirection = cursor.direction.slice(-1)\n    position[limitedDirection] = cursor.start[limitedDirection]\n    cursor.hover.copyFrom(position)\n    cursor.min = Vector3.Minimize(cursor.start, position)\n    cursor.max = Vector3.Maximize(cursor.start, position).add(new Vector3(1, 1, 1))\n\n    cursorHover.position.copyFrom(position.add(new Vector3(0.5, 0.5, 0.5)))\n\n    const { x, y, z } = position,\n      { min, max } = cursor,\n      leftText = !cursorHover.isVisible ? '' : `(${[x, y, z]})`,\n      rightText = !cursorSelect.isVisible ? '' : min.equals(max) ?\n        `(${[min.x, min.y, min.z]})` : `(${[min.x, min.y, min.z]} ~ ${[max.x, max.y, max.z]})`\n    bottomText.text = [leftText, rightText].join(' ')\n  })\n\n  let cursorPixel = { } as { t: number, h: number }\n  attachDragable(elem, evt => {\n    cursorPixel = ui.selectedTile as any\n    if (cursorPixel.h !== undefined) {\n      const h = parseInt(cursorPixel.h ? cursorPixel.h + '' : '0')\n      cursorPixel.h = cursor.start.y + h\n    }\n\n    if (cursor.shiftKey) {\n      //...\n    }\n    else {\n      chunks.setPixel(cursor.hover.x, cursor.hover.z, cursorPixel)\n    }\n  }, evt => {\n    if (cursor.shiftKey) {\n      const { min, max } = cursor\n      cursorSelect.position.copyFrom(min.add(max).scale(0.5))\n      cursorSelect.scaling.copyFrom(max.subtract(min))\n    }\n    else {\n      cursorSelect.position.copyFrom(cursor.hover.add(new Vector3(0.5, 0.5, 0.5)))\n      chunks.setPixel(Math.floor(cursor.hover.x), Math.floor(cursor.hover.z), cursorPixel)\n    }\n  }, evt => {\n    if (cursor.shiftKey) {\n      const { min, max } = cursor\n      for (let m = min.x; m < max.x; m ++) {\n        for (let n = min.z; n < max.z; n ++) {\n          chunks.setPixel(Math.floor(m), Math.floor(n), cursorPixel)\n        }\n      }\n      cameraTarget.copyFrom(cursorSelect.position)\n    }\n  }, evt => {\n    return cameraDetached\n  })\n\n  // ...\n  for (const id in IMG_ASSETS) {\n    const src = IMG_ASSETS[id]\n    await new Promise((onload, onerror) => appendElement('img', { src, id, onload, onerror }))\n  }\n  const tiles = TILE_ASSETS.map(([srcId, offsetX, offsetY, size, isAutoTile]) => {\n    const src = document.getElementById(srcId as string) as HTMLImageElement\n    return { src, offsetX, offsetY, size, isAutoTile }\n  })\n\n  // ...\n  const chunks = new Chunks(scene, tiles),\n    ui = new UI(tiles)\n\n  ui.addEventListener('tile-select', () => {\n    const min = cursorSelect.position.subtract(cursorSelect.scaling.scale(0.5)),\n      max = cursorSelect.position.add(cursorSelect.scaling.scale(0.5))\n    if (keys.ctrlKey || keys.shiftKey) {\n      for (let m = min.x; m < max.x; m ++) {\n        for (let n = min.z; n < max.z; n ++) {\n          chunks.setPixel(Math.floor(m), Math.floor(n), ui.selectedTile)\n        }\n      }\n    }\n  })\n\n  const cameraTarget = Vector3.Zero()\n  let cameraDetached = true\n  scene.registerBeforeRender(() => {\n    if ((keys.ctrlKey || keys.shiftKey) && !cameraDetached && (cameraDetached = true)) {\n      camera.detachControl(elem)\n    }\n    else if (!(keys.ctrlKey || keys.shiftKey) && cameraDetached && !(cameraDetached = false)) {\n      camera.attachControl(elem)\n    }\n\n    cursorSelect.isVisible = cursorHover.isVisible = cameraDetached\n\n    const delta = camera.target.subtract(camera.position)\n    camera.setTarget(Vector3.Lerp(camera.target, cameraTarget, 0.1))\n    camera.setPosition(camera.target.subtract(delta))\n  })\n\n})()\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import {\n  Scene,\n  Mesh,\n  MeshBuilder,\n  Texture,\n  DynamicTexture,\n  StandardMaterial,\n  Vector2,\n  Vector3,\n  Vector4,\n  Color3,\n  Color4,\n} from '../babylon'\n\nimport {\n  getAutoTileImage,\n  AUTO_TILE_NEIGHBORS,\n} from './tiles'\n\nimport {\n  WireframeNoLightingMaterial,\n} from './babylon'\n\nimport {\n  throttle,\n  getBlocksFromHeightMap,\n} from './'\n\nexport interface ChunkData {\n  ground: Mesh\n  texture: DynamicTexture\n  tiles: number[]\n  heights: number[]\n  i: number\n  j: number\n  k: string\n  blockCache: { [key: string]: Mesh }\n}\n\nexport interface TileDefine {\n  src: HTMLImageElement\n  offsetX: number\n  offsetY: number\n  size: number\n  isAutoTile: boolean\n}\n\nexport default class Chunks {\n  private readonly chunkGrids: number\n  private readonly texturePixel: number\n  private readonly waterMaterial: StandardMaterial\n  private data: { [key: string]: ChunkData } = { }\n\n  constructor(private scene: Scene,\n    readonly tiles: TileDefine[],\n    readonly gridSize = 1,\n    readonly chunkSize = 16,\n    readonly textureSize = 16 * 32) {\n    this.chunkGrids = Math.floor(chunkSize / gridSize)\n    this.texturePixel = Math.floor(textureSize / this.chunkGrids)\n\n    const WaterMaterial = (BABYLON as any)['WaterMaterial']\n    if (WaterMaterial) {\n      const water = this.waterMaterial = new WaterMaterial('water', scene);\n      water.bumpTexture = new Texture('assets/waterbump.png', scene);\n      water.windForce = -5;\n      water.waveHeight = 0.02;\n      water.bumpHeight = 0.02;\n      water.waterColor = new Color3(0.047, 0.23, 0.015);\n      water.colorBlendFactor = 0.5;\n    }\n    else {\n      console.warn('add babylon.waterMaterial.js to enable water material')\n      const water = this.waterMaterial = new StandardMaterial('water', scene)\n      water.diffuseColor = new Color3(0.047, 0.23, 0.015)\n    }\n  }\n\n  private getChunkData(m: number, n: number) {\n    const { chunkSize, chunkGrids, gridSize, scene, textureSize, texturePixel } = this,\n      i = Math.floor(m / chunkGrids),\n      j = Math.floor(n / chunkGrids),\n      k = [i, j].join('/')\n\n    if (!this.data[k]) {\n      const tiles = Array(chunkGrids * chunkGrids).fill(null),\n        heights = tiles.map(t => null),\n        blockCache = { }\n\n      const ground = new Mesh(`ground-${k}`, scene)\n      ground.position.copyFromFloats((i + 0.5) * chunkSize, 0, (j + 0.5) * chunkSize)\n\n      const material = ground.material = new StandardMaterial(`ground-mat-${k}`, scene)\n      material.disableLighting = true\n      material.alpha = 1\n      material.emissiveColor = new Color3(1, 1, 1)\n\n      const texture = material.diffuseTexture =\n        new DynamicTexture(`ground-tex-${k}`, textureSize, scene, true, BABYLON.Texture.NEAREST_SAMPLINGMODE),\n        dc = texture.getContext(),\n        { src, offsetX, offsetY, size } = this.tiles[0]\n      for (let dx = 0; dx < textureSize; dx += texturePixel) {\n        for (let dy = 0; dy < textureSize; dy += texturePixel) {\n          dc.drawImage(src, offsetX, offsetY, size, size, dx, dy, size, size)\n        }\n      }\n\n      texture.update()\n\n      this.data[k] = { ground, blockCache, texture, tiles, heights, i, j, k }\n      this.updateHeight(m, n)\n    }\n\n    return this.data[k]\n  }\n\n  private updateTexture(m: number, n: number, t: number) {\n    const { texture, i, j } = this.getChunkData(m, n),\n      dc = texture.getContext(),\n      { texturePixel, textureSize } = this,\n      g = this.chunkGrids,\n      u = m - i * g,\n      v = n - j * g,\n      dx = u * texturePixel,\n      dy = textureSize - (v + 1) * texturePixel\n\n    const { src, offsetX, offsetY, size, isAutoTile } = this.tiles[0]\n    dc.drawImage(src, offsetX, offsetY, size, size, dx, dy, size, size)\n\n    if (this.tiles[t]) {\n      const { src, offsetX, offsetY, size, isAutoTile } = this.tiles[t]\n      if (isAutoTile) {\n        const neighbors = AUTO_TILE_NEIGHBORS\n            .map(([i, j]) => this.getPixel(m + i, n + j))\n            .reduce((s, p, j) => s + (p.t === t ? 1 << j : 0), 0)\n        const { im, sx, sy } = getAutoTileImage(src, offsetX, offsetY, size, neighbors)\n        dc.drawImage(im, sx, sy, size, size, dx, dy, texturePixel, texturePixel)\n      }\n      else {\n        dc.drawImage(src, offsetX, offsetY, size, size, dx, dy, texturePixel, texturePixel)\n      }\n    }\n\n    texture.update()\n  }\n\n  private updateHeight(m: number, n: number) {\n    const { chunkGrids, gridSize, chunkSize, scene } = this,\n      { heights, ground, blockCache } = this.getChunkData(m, n),\n      blocks = getBlocksFromHeightMap(heights, chunkGrids),\n      offset = new Vector3(chunkSize / 2, 0, chunkSize / 2),\n      added = { } as { [key: string]: boolean }\n\n    if (Math.min.apply(Math, heights) < 0) {\n      const id = 'water'\n      if (!blockCache[id]) {\n        const mesh = blockCache[id] = Mesh.CreateGround('', chunkSize, chunkSize, 32, scene)\n        mesh.position.y = -0.2\n        mesh.material = this.waterMaterial\n        mesh.parent = ground\n      }\n      added[id] = true\n    }\n\n    blocks.forEach(block => {\n      const [u0, u1, v0, v1, h0, h1] = block,\n        p0 = new Vector3(u0, h0, v0),\n        p1 = new Vector3(u1, h1, v1),\n        id = block.join('/')\n      if (!blockCache[id]) {\n        const faceUV = [\n          Vector4.Zero(),\n          Vector4.Zero(),\n          Vector4.Zero(),\n          Vector4.Zero(),\n          new Vector4(u0, v0, u1, v1).scaleInPlace(1 / chunkGrids),\n          Vector4.Zero(),\n        ]\n        const faceColors = [\n          new Color4(0.1, 0.1, 0.1, 1),\n          new Color4(0.1, 0.1, 0.1, 1),\n          new Color4(0.1, 0.1, 0.1, 1),\n          new Color4(0.1, 0.1, 0.1, 1),\n          new Color4(1, 1, 1, 0),\n          new Color4(0.1, 0.1, 0.1, 1),\n        ]\n\n        const mesh = blockCache[id] = MeshBuilder.CreateBox(id, { faceUV, faceColors }, scene)\n        mesh.position.copyFrom(p1.add(p0).scale(gridSize / 2).subtract(offset))\n        mesh.scaling.copyFrom(p1.subtract(p0).scale(gridSize))\n        mesh.material = ground.material\n        mesh.parent = ground\n\n        // this fixes uv mismatch issue\n        const { x, z } = mesh.scaling\n        mesh.scaling.x = z\n        mesh.scaling.z = x\n        mesh.rotation.y = Math.PI / 2\n\n        if (h1 < 0) {\n          (this.waterMaterial as any).addToRenderList(mesh)\n        }\n      }\n      added[id] = true\n    })\n\n    Object.keys(blockCache).filter(id => !added[id]).forEach(id => {\n      blockCache[id].dispose()\n      delete blockCache[id]\n    })\n  }\n\n  private throttleUpdate = throttle(this.batchUpdateChunk.bind(this), 50)\n  private chunkTextureToUpdate = { } as { [index: string]: number }\n  private chunkHeightToUpdate = { } as { [index: string]: string }\n  private batchUpdateChunk() {\n    Object.keys(this.chunkTextureToUpdate).forEach(index => {\n      const [m, n] = index.split('/').map(parseFloat),\n        v = this.chunkTextureToUpdate[index]\n      this.updateTexture(m, n, v)\n    })\n    this.chunkTextureToUpdate = { }\n\n    Object.keys(this.chunkHeightToUpdate).forEach(index => {\n      const mn = this.chunkHeightToUpdate[index],\n        [m, n] = mn.split('/').map(parseFloat)\n      this.updateHeight(m, n)\n    })\n    this.chunkHeightToUpdate = { }\n  }\n\n  setPixel(m: number, n: number, p: { t?: number, h?: number | string }) {\n    const { tiles, heights, i, j, k } = this.getChunkData(m, n),\n      g = this.chunkGrids,\n      u = m - i * g,\n      v = n - j * g,\n      c = u * g + v\n\n    if (typeof p.t === 'number' && tiles[c] !== p.t) {\n      const u = tiles[c]\n      tiles[c] = p.t\n\n      this.chunkTextureToUpdate[ [m, n].join('/') ] = p.t\n      const tileV = this.tiles[p.t], tileU = this.tiles[u]\n      if ((tileV && tileV.isAutoTile) || (tileU && tileU.isAutoTile)) {\n        AUTO_TILE_NEIGHBORS.forEach(([i, j]) => {\n          const pixel = this.getPixel(m + i, n + j),\n            tile = this.tiles[pixel.t]\n          if (tile && tile.isAutoTile) {\n            this.chunkTextureToUpdate[ [m + i, n + j].join('/') ] = pixel.t\n          }\n        })\n      }\n    }\n\n    if (typeof p.h === 'string') {\n      p.h = (heights[c] || 0) + parseFloat(p.h)\n    }\n    if (typeof p.h === 'number' && heights[c] !== p.h) {\n      heights[c] = p.h\n      this.chunkHeightToUpdate[k] = [m, n].join('/')\n    }\n\n    this.throttleUpdate()\n    return { t: tiles[c], h: heights[c] }\n  }\n\n  getPixel(m: number, n: number) {\n    const { tiles, heights, i, j, k } = this.getChunkData(m, n),\n      g = this.chunkGrids,\n      u = m - i * g,\n      v = n - j * g,\n      c = u * g + v\n    return { t: tiles[c], h: heights[c] }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/chunks.ts","/// <reference path=\"../node_modules/babylonjs/babylon.d.ts\" />\nexport = BABYLON\n\n\n// WEBPACK FOOTER //\n// ./src/babylon.ts","import {\n  ArrayHash\n} from './index'\n\nexport const AUTO_TILE_MAP = [\n  {\n    dst: [0, 0],\n    mask: [0, 1, 2],\n    src: [[0, 2], [1, 2], [0, 2], [2, 2], [0, 3], [2, 0], [0, 3], [1, 4]],\n  },\n  {\n    dst: [1, 0],\n    mask: [2, 3, 4],\n    src: [[3, 2], [3, 3], [3, 2], [3, 4], [2, 2], [3, 0], [1, 2], [2, 4]],\n  },\n  {\n    dst: [1, 1],\n    mask: [4, 5, 6],\n    src: [[3, 5], [2, 5], [3, 5], [1, 5], [3, 3], [3, 1], [3, 4], [2, 3]],\n  },\n  {\n    dst: [0, 1],\n    mask: [6, 7, 0],\n    src: [[0, 5], [0, 4], [0, 5], [0, 3], [1, 5], [2, 1], [2, 5], [1, 3]],\n  },\n]\n\nexport const AUTO_TILE_NEIGHBORS = [\n  [-1,  0],\n  [-1,  1],\n  [ 0,  1],\n  [ 1,  1],\n  [ 1,  0],\n  [ 1, -1],\n  [ 0, -1],\n  [-1, -1],\n]\n\nfunction getMaskBits(neighbors: number, mask: number[]) {\n  return mask.reduce((s, i, j) => s + (neighbors & (1 << i) ? (1 << j) : 0), 0)\n}\n\nconst tileCaches = new ArrayHash<HTMLImageElement, { [offset: string]: {\n  canvas: HTMLCanvasElement,\n  dict: { [key: string]: boolean }\n} }>()\n\n// the size of autotile should be 2*3 tileSize\nexport function getAutoTileImage(source: HTMLImageElement,\n    offsetX: number, offsetY: number,\n    tileSize: number, neighbors: number) {\n  const cache = tileCaches.get(source) || tileCaches.set(source, { }),\n    key = [offsetX, offsetY, tileSize].join('/')\n  if (!cache[key]) {\n    const canvas = document.createElement('canvas')\n    canvas.width = tileSize\n    canvas.height = 256 * tileSize\n    const dict = { }\n    cache[key] = { canvas, dict }\n  }\n\n  const { canvas, dict } = cache[key],\n    hw = tileSize / 2\n  if (!dict[key + neighbors]) {\n    const dc = canvas.getContext('2d')\n    AUTO_TILE_MAP.forEach(({ dst, mask, src }) => {\n      const b = getMaskBits(neighbors, mask),\n        [i, j] = src[b],\n        sx = offsetX + i * hw,\n        sy = offsetY + j * hw,\n        [m, n] = dst,\n        dx = m * hw,\n        dy = n * hw + neighbors * tileSize\n      dc.drawImage(source, sx, sy, hw, hw, dx, dy, hw, hw)\n    })\n    dict[key + neighbors] = true\n  }\n\n  return { im: canvas, sx: 0, sy: neighbors * tileSize }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/tiles.ts","export class ArrayHash<K, V> {\n  data = [ ] as [K, V][]\n  get(key: K) {\n    const find = this.data.filter(([k, v]) => k === key).pop()\n    return find && find[1]\n  }\n  del(key: K) {\n    this.data = this.data.filter(([k, v]) => k !== key)\n  }\n  set(key: K, val: V) {\n    const find = this.data.filter(([k, v]) => k === key).pop()\n    if (find) {\n      find[1] = val\n    }\n    else {\n      this.data.push([key, val])\n    }\n    return val\n  }\n}\n\nexport function debounce<F extends Function>(fn: F, delay: number) {\n  let timeout = 0\n  return function () {\n    const that = this, args = arguments\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => {\n      fn.apply(that, args)\n      timeout = 0\n    }, delay)\n  } as any as F\n}\n\nexport function throttle<F extends Function>(fn: F, delay: number) {\n  let timeout = 0\n  return function () {\n    const that = this, args = arguments\n    if (timeout) {\n      return\n    }\n    timeout = setTimeout(() => {\n      fn.apply(that, args)\n      timeout = 0\n    }, delay)\n  } as any as F\n}\n\ntype N = number\nexport function getBlocksFromHeightMap(heights: number[], n: number) {\n  const blocks = [ ] as number[][],\n    hMin = Math.min.apply(Math, heights) - 2,\n    val = heights.map(h => hMin),\n    find2 = (i0: N, i1: N, j0: N, j1: N, fn: (...key: N[]) => boolean) => {\n      for (let i = i0; i < i1; i ++) {\n        for (let j = j0; j < j1; j ++) {\n          const c = i * n + j\n          if (fn(heights[c], val[c], c, i, j)) {\n            return { i, j }\n          }\n        }\n      }\n    },\n    each2 = (i0: N, i1: N, j0: N, j1: N, fn: (...key: N[]) => void) => {\n      find2(i0, i1, j0, j1, function() { return fn.apply(null, arguments) && false })\n    }\n\n  let f = find2(0, n, 0, n, (a, b) => a > b)\n  while (f) {\n    const i0 = f.i, j0 = f.j, h0 = val[i0 * n + j0]\n\n    let i1 = i0 + 1, j1 = j0 + 1\n    while (!find2(i1, i1 + 1, j0, j0 + 1, (a, b) => a <= h0 || b !== h0)) i1 ++\n    while (!find2(i0, i1,     j1, j1 + 1, (a, b) => a <= h0 || b !== h0)) j1 ++\n\n    let h1 = 1/0\n    each2(i0, i1, j0, j1, (a, b, c) => h1 = Math.min(h1, a))\n    each2(i0, i1, j0, j1, (a, b, c) => val[c] = h1)\n    blocks.push([i0, i1, j0, j1, h0, h1])\n\n    f = find2(0, n, 0, n, (a, b) => a > b)\n  }\n\n  return blocks\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.ts","import {\n  appendElement\n} from './utils/dom'\n\nimport {\n  TileDefine\n} from './utils/chunks'\n\nimport {\n  ArrayHash\n} from './utils'\n\ntype UiEvents = 'panel-change' | 'tile-select' | 'focus-cursor'\n\nexport class UI {\n  constructor(tiles: TileDefine[],\n      private panel = document.querySelector('.ui-panel-selector') as HTMLSelectElement,\n      private focus = document.querySelector('.ui-focus-cursor') as HTMLButtonElement) {\n    this.panel.addEventListener('change', evt => {\n      for (const elem of document.querySelectorAll('.ui-panel')) {\n        elem.classList.add('hidden')\n      }\n      for (const elem of document.querySelectorAll('.ui-panel.panel-' + this.panel.value)) {\n        elem.classList.remove('hidden')\n      }\n      for (const option of this.panel.childNodes) {\n        document.body.classList.remove('on-panel-' + (option as HTMLOptionElement).value)\n      }\n      document.body.classList.add('on-panel-' + this.panel.value)\n\n      if (this.panel['last-value'] !== this.panel.value) {\n        ;(this.callbacks['panel-change'] || [ ]).forEach(cb => cb(this.panel['last-value']))\n        this.panel['last-value'] = this.panel.value\n      }\n    })\n\n    setTimeout(_ => this.panel.dispatchEvent(new Event('change')), 100)\n\n    this.focus.addEventListener('click', evt => {\n      (this.callbacks['focus-cursor']).forEach(cb => cb())\n    })\n\n    const tilesList = document.querySelector('.ui-paint-tiles')\n    tiles.forEach((tile, index) => {\n      const { src, offsetX, offsetY, size } = tile,\n        attrs = { className: 'ui-paint-tile', attributesToSet: { 'tile-index': index } },\n        div = appendElement('div', attrs, tilesList) as HTMLDivElement,\n        [width, height] = [32, 32],\n        canvas = appendElement('canvas', { width, height }, div) as HTMLCanvasElement\n      canvas.getContext('2d').drawImage(src, offsetX, offsetY, size, size, 0, 0, width, height)\n    })\n\n    for (const elem of document.querySelectorAll('.ui-paint-tile *')) {\n      elem.addEventListener('click', evt => {\n        for (const selected of document.querySelectorAll('.ui-paint-tile.selected')) {\n          selected.classList.remove('selected')\n        }\n        elem.parentElement.classList.add('selected')\n        ;(this.callbacks['tile-select'] || [ ]).forEach(cb => cb())\n      })\n    }\n  }\n\n  get activePanel() {\n    return this.panel.value\n  }\n\n  set activePanel(val) {\n    this.panel.value = val\n    this.panel.dispatchEvent(new Event('change'))\n  }\n\n  get selectedTile() {\n    const div = document.querySelector('.ui-paint-tile.selected'),\n      tileIndex = div && div.getAttribute('tile-index'),\n      tileHeight = div && div.getAttribute('tile-height')\n    return (tileIndex && { t: parseInt(tileIndex) }) || (tileHeight && { h: tileHeight })\n  }\n\n  private callbacks = { } as { [P in UiEvents]: Function[] }\n  addEventListener(evt: UiEvents, callback: Function) {\n    const cbs = this.callbacks[evt] || (this.callbacks[evt] = [ ])\n    if (cbs.indexOf(callback) === -1) {\n      cbs.push(callback)\n    }\n  }\n  removeEventListener(evt: UiEvents, callback: (evt?) => void) {\n    const cbs = this.callbacks[evt]\n    if (cbs) {\n      cbs.splice(cbs.indexOf(callback), 1)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui.ts","export function appendElement(tag, attrs = { } as any, parent = document.body as Element) {\n  const elem = Object.assign(document.createElement(tag), attrs)\n  Object.assign(elem.style, attrs.style)\n  if (attrs.attributesToSet) for (const key in attrs.attributesToSet) {\n    elem.setAttribute(key, attrs.attributesToSet[key])\n  }\n  parent && parent.appendChild(elem)\n  return elem\n}\n\nexport function attachDragable(\n  elem: HTMLElement,\n  onDown:  (evt: MouseEvent) => void,\n  onMove?: (evt: MouseEvent) => void,\n  onUp?:   (evt: MouseEvent) => void,\n  filter?: (evt: MouseEvent) => boolean) {\n  \n  function handleMouseDown(evt) {\n    window.removeEventListener('mousemove', handleMouseMove)\n    window.removeEventListener('mouseup', handleMouseUp)\n    if (!filter || filter(evt)) {\n      onDown(evt)\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    }\n  }\n\n  function handleMouseMove(evt) {\n    onMove && onMove(evt)\n  }\n\n  function handleMouseUp(evt) {\n    window.removeEventListener('mousemove', handleMouseMove)\n    window.removeEventListener('mouseup', handleMouseUp)\n    onUp && onUp(evt)\n  }\n\n  elem.addEventListener('mousedown', handleMouseDown)\n  return () => {\n    elem.removeEventListener('mousedown', handleMouseDown)\n    window.removeEventListener('mousemove', handleMouseMove)\n    window.removeEventListener('mouseup', handleMouseUp)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/dom.ts","import {\n  VertexData,\n  Scene,\n  Color3,\n  StandardMaterial,\n} from '../babylon'\n\nimport {\n  ArrayHash\n} from './'\n\nexport const VERTEX_BOX      = VertexData.CreateBox({ })\nexport const VERTEX_SPHERE   = VertexData.CreateSphere({ })\nexport const VERTEX_PLANE    = VertexData.CreatePlane({ })\nexport const VERTEX_GROUND   = VertexData.CreateGround({ })\nexport const VERTEX_CYLINDER = VertexData.CreateCylinder({ height: 1, diameter: 1 })\n\nexport class WireframeNoLightingMaterial extends StandardMaterial {\n  constructor(name: string, scene: Scene, color?: Color3) {\n    super(name, scene)\n    this.emissiveColor = color || new Color3(1, 1, 1)\n    this.wireframe = true\n    this.disableLighting = true\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/babylon.ts"],"sourceRoot":""}